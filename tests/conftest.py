import pytest


@pytest.fixture
def valid_sns_message() -> bytes:
    return b'{\n  "Type" : "Notification",\n  "MessageId" : "fdc17b0f-e33d-5e06-ba46-1a06a8f3fcb7",\n  "TopicArn" : "arn:aws:sns:us-west-1:523571139036:email-received-notifications",\n  "Subject" : "Amazon SES Email Receipt Notification",\n  "Message" : "{\\"notificationType\\":\\"Received\\",\\"mail\\":{\\"timestamp\\":\\"2025-08-03T11:35:40.633Z\\",\\"source\\":\\"yagiz.kilicarslan@areal.ai\\",\\"messageId\\":\\"9fup0o4nvdb5jdt07p21k3njkl2e003s44uqh5g1\\",\\"destination\\":[\\"document@process.areal.ai\\"],\\"headersTruncated\\":false,\\"headers\\":[{\\"name\\":\\"Return-Path\\",\\"value\\":\\"<yagiz.kilicarslan@areal.ai>\\"},{\\"name\\":\\"Received\\",\\"value\\":\\"from mail-wr1-f44.google.com (mail-wr1-f44.google.com [209.85.221.44]) by inbound-smtp.us-west-1.amazonaws.com with SMTP id 9fup0o4nvdb5jdt07p21k3njkl2e003s44uqh5g1 for document@process.areal.ai; Sun, 03 Aug 2025 11:35:40 +0000 (UTC)\\"},{\\"name\\":\\"Received-SPF\\",\\"value\\":\\"pass (spfCheck: domain of areal.ai designates 209.85.221.44 as permitted sender) client-ip=209.85.221.44; envelope-from=yagiz.kilicarslan@areal.ai; helo=mail-wr1-f44.google.com;\\"},{\\"name\\":\\"Authentication-Results\\",\\"value\\":\\"amazonses.com; spf=pass (spfCheck: domain of areal.ai designates 209.85.221.44 as permitted sender) client-ip=209.85.221.44; envelope-from=yagiz.kilicarslan@areal.ai; helo=mail-wr1-f44.google.com; dkim=pass header.i=@areal.ai; dmarc=pass header.from=areal.ai;\\"},{\\"name\\":\\"X-SES-RECEIPT\\",\\"value\\":\\"AEFBQUFBQUFBQUFGRDc5TUk2NWxsUE5BeExjMC84MEhvMk8ydjJzSHE1cWZPa3N6Y3g4WC9BNFZKMTlNNlFjVUErOXRpL0w0NXFicWpkSkNUamNtdDRRY01LNmgrUVJ3QWtrU0lzQmZqa0NQVThDdVFnZlNvKzJFemNIUk9kS1p3TGFKNGtNL1ZBY0Nmb2RBclg4Y1dNWU5QdDBKRGRkZG9HOFhiM3pVN1MzTW9BTVdvRlZwVkhYaU5ydHhDdFA2TDM4dXBTSFcrY0FEd2xLWkEveTllRzBmNmxOR1lnNE9zOTB0bmZ6TEZJQVk2UlE4OW9Banh0V25JRHdaVm8vRmZ4ajNmUVZlSkRLZnRVR3hNd09EZWJYRWNGTTV5RkxwWWRoVUI1c3hSd2Z1ZW1RRE9ZdFdENVJmc2g2RHFmNldjWitWNGt2eGlkeWc9\\"},{\\"name\\":\\"X-SES-DKIM-SIGNATURE\\",\\"value\\":\\"a=rsa-sha256; q=dns/txt; b=ZXHtFVnPq9ALcwkr01bVTWsxNBe8Vk3YCLzAB/YyIQaV+2U8CSDpGQYO+eIDc7liZyzw6KJ0gbh79+dsGL92g4VaXrdJhnLvyk0BnKzGqWLY87xsUGXe0KMEY+ipKapNifI8lmpg8QRPsC59FHIlmKUcne/CD6d1jbUnLPaEWhg=; c=relaxed/simple; s=th56fxceawp6wyoy6vlgnav4xsxoa5ue; d=amazonses.com; t=1754220942; v=1; bh=Pkq9oJsMDcd2Cfn5P9V7iQZ6r82QvyK5ejNlJ/fnzd0=; h=From:To:Cc:Bcc:Subject:Date:Message-ID:MIME-Version:Content-Type:X-SES-RECEIPT;\\"},{\\"name\\":\\"Received\\",\\"value\\":\\"by mail-wr1-f44.google.com with SMTP id ffacd0b85a97d-3b79bdc9a7dso1886224f8f.1 for <document@process.areal.ai>; Sun, 03 Aug 2025 04:35:40 -0700 (PDT)\\"},{\\"name\\":\\"DKIM-Signature\\",\\"value\\":\\"v=1; a=rsa-sha256; c=relaxed/relaxed; d=areal.ai; s=google; t=1754220938; x=1754825738; darn=process.areal.ai; h=organization:subject:from:to:content-language:user-agent:mime-version:date:message-id:from:to:cc:subject:date:message-id:reply-to; bh=Pkq9oJsMDcd2Cfn5P9V7iQZ6r82QvyK5ejNlJ/fnzd0=; b=ngCsVj19iCwYNtK0b1xqhHbwKZE9ldq10vnGrhtZ3I7ZmQNR1TJa4XcS99AZnHAPz1a3R6270tfJ6+1AucSfgQ/57A3FGodlvPIHLORWYxtDpuWWhibZqoaFiWb8ZOXlCFT9gAqyeodnW6lSNRwoL3G4If+PwsLuPeAIRlSp20c=\\"},{\\"name\\":\\"X-Google-DKIM-Signature\\",\\"value\\":\\"v=1; a=rsa-sha256; c=relaxed/relaxed; d=1e100.net; s=20230601; t=1754220938; x=1754825738; h=organization:subject:from:to:content-language:user-agent :mime-version:date:message-id:x-gm-message-state:from:to:cc:subject :date:message-id:reply-to; bh=Pkq9oJsMDcd2Cfn5P9V7iQZ6r82QvyK5ejNlJ/fnzd0=; b=KxSW3ZgwUwF7i9WnYiDV+m9DiQjNRSroxr8jFFKlXqks5OH96aJLulpQJA6zuBmhAo b7st7DB5AX9bKtVOHOVxs6/lyhXEUCBSj79t2aa9GNWbbKwTZCuZOJ+Gf4Li4yABhu1D SVT2U63iWmz2EpwSya6Tc/dug0B/LiRKYBy+027NUGMgJf5QNtqTeMI+8ayJrpiVX7Tx tf8O0yld0FdiDcT4SrIyPOEze+eJplEwvckCSBknQAnI6HL9Gbqyh12FpYTrFUlGWqqx E7WJPX43A3Tne3wpT3z1pSkeSk5nGed7E4EpgoggrWvtEKxMinBndgPkUkbHhJR+KLKC J/6Q==\\"},{\\"name\\":\\"X-Gm-Message-State\\",\\"value\\":\\"AOJu0YyDiwr80fK0ghmn6VgH+kUPXAsuVPOj9PJsDlLCpL6H4Bt8WGM8 srEGKPS90vMHqXcJs6tzhAVNI/JSFHdx6mncuRWSdNQPOrhXXywF5CtVgHwy6VwS0kHp4ZRS9+6 Ky4L3OTI=\\"},{\\"name\\":\\"X-Gm-Gg\\",\\"value\\":\\"ASbGncvGZqdYvGZv0828hE7ElOTRanphIrGP0sx0VLdTJ5rC1WbF476Cj52o5NJ41Qr k9N8vHxthlty1Bb2t2D9rR9AdCgBaaqiB00Q/WWiXQyNsyiim9Pge+ZQ1u0NmIAFxVhdBVDrZEK CRCHOuMqNZ0Bte27RDgkcfneNIe4MIohgFXQNmxvaWo7VTqw4xDp030gh0/Y1vAqbwqFAF7YoOK kKKSEuCtxNtNxWsf+i9ZHB72XEC4K8jn34QNNxL+qFy60W0KywVVYVAd9pmv9IkMEDbPP3extDt WAxar2agiY+eOqr2QhrFjnEDnnTe02x+3+hHYMJAnoJ59My1xawZxmQnFNrLWKp6kqa3w/9+eOY 8n4mLXL+snBpW3FQae39fsaotnjOTVoOd+diVbPnVY8R6i/fwAGFP7nPnGm9DucYktYAtn9ZViM Vi+JdZxA+kYFpTRatVSQYVSIDrHcoA5jwVaA==\\"},{\\"name\\":\\"X-Google-Smtp-Source\\",\\"value\\":\\"AGHT+IFyCzv7SG0u2I7TxqjEfKqEL3TNI5auz3bfTB17FxyATt0QqYWbEIvSU2+8XMmIE6EKYHjgZQ==\\"},{\\"name\\":\\"X-Received\\",\\"value\\":\\"by 2002:a05:6000:2013:b0:3b8:d1d9:70ba with SMTP id ffacd0b85a97d-3b8d94bb354mr4199268f8f.32.1754220937058; Sun, 03 Aug 2025 04:35:37 -0700 (PDT)\\"},{\\"name\\":\\"Return-Path\\",\\"value\\":\\"<yagiz.kilicarslan@areal.ai>\\"},{\\"name\\":\\"Received\\",\\"value\\":\\"from ?IPV6:2a00:1d34:8a8:8100:e8c2:d5d:c0fd:b632? ([2a00:1d34:8a8:8100:e8c2:d5d:c0fd:b632]) by smtp.gmail.com with ESMTPSA id ffacd0b85a97d-3b79c3b95f4sm11961696f8f.23.2025.08.03.04.35.34 for <document@process.areal.ai> (version=TLS1_3 cipher=TLS_AES_128_GCM_SHA256 bits=128/128); Sun, 03 Aug 2025 04:35:35 -0700 (PDT)\\"},{\\"name\\":\\"Content-Type\\",\\"value\\":\\"multipart/mixed; boundary=\\\\\\"------------O16Tozqg5qsp51dMPUhx002F\\\\\\"\\"},{\\"name\\":\\"Message-ID\\",\\"value\\":\\"<1f1c9219-7ad0-4246-97c9-2d7aa1b84328@areal.ai>\\"},{\\"name\\":\\"Date\\",\\"value\\":\\"Sun, 3 Aug 2025 14:35:33 +0300\\"},{\\"name\\":\\"MIME-Version\\",\\"value\\":\\"1.0\\"},{\\"name\\":\\"User-Agent\\",\\"value\\":\\"Mozilla Thunderbird\\"},{\\"name\\":\\"Content-Language\\",\\"value\\":\\"en-US\\"},{\\"name\\":\\"To\\",\\"value\\":\\"document@process.areal.ai\\"},{\\"name\\":\\"From\\",\\"value\\":\\"yagiz kilicarslan <yagiz.kilicarslan@areal.ai>\\"},{\\"name\\":\\"Subject\\",\\"value\\":\\"lutfenn\\"},{\\"name\\":\\"Organization\\",\\"value\\":\\"Areal AI\\"}],\\"commonHeaders\\":{\\"returnPath\\":\\"yagiz.kilicarslan@areal.ai\\",\\"from\\":[\\"yagiz kilicarslan <yagiz.kilicarslan@areal.ai>\\"],\\"date\\":\\"Sun, 3 Aug 2025 14:35:33 +0300\\",\\"to\\":[\\"document@process.areal.ai\\"],\\"messageId\\":\\"<1f1c9219-7ad0-4246-97c9-2d7aa1b84328@areal.ai>\\",\\"subject\\":\\"lutfenn\\"}},\\"receipt\\":{\\"timestamp\\":\\"2025-08-03T11:35:40.633Z\\",\\"processingTimeMillis\\":1769,\\"recipients\\":[\\"document@process.areal.ai\\"],\\"spamVerdict\\":{\\"status\\":\\"DISABLED\\"},\\"virusVerdict\\":{\\"status\\":\\"DISABLED\\"},\\"spfVerdict\\":{\\"status\\":\\"PASS\\"},\\"dkimVerdict\\":{\\"status\\":\\"PASS\\"},\\"dmarcVerdict\\":{\\"status\\":\\"PASS\\"},\\"action\\":{\\"type\\":\\"S3\\",\\"topicArn\\":\\"arn:aws:sns:us-west-1:523571139036:email-received-notifications\\",\\"bucketName\\":\\"areal-v2-uploads-development\\",\\"objectKeyPrefix\\":\\"areal-domain/\\",\\"objectKey\\":\\"areal-domain/9fup0o4nvdb5jdt07p21k3njkl2e003s44uqh5g1\\"}}}",\n  "Timestamp" : "2025-08-03T11:35:42.425Z",\n  "SignatureVersion" : "1",\n  "Signature" : "Ald16+KJr4mQ44wGtqtsfk7Zt5AFLmD2NM1sYeVuol0D0aKqZ7Tws3rDlcmZ3EAknnNp9jfV7s5jZsmF7pbCpSxjXQoSJU2QbnmqRSgBeJPVwlpLnmpOzvy06Gce2eCd6wCyOWIorNekSlpD6IYHTOn5BUmih6G/JgA2PZpXO9jL7c+KLMkNa3AyI3MVKLFcI+U7pJVBKiGue5DFU4AgLEwJzJMxszjP1RetlMgf+laCcAHfWAWJRAd/vPn7QNF/rRZ4flJQk0X08OrGhamjX0TDT6nvBHVxWpvHrj1iSSUCGxwKf1aqfODXQT7nDLmO4+eTbVNa4wq6QaCINpE6eA==",\n  "SigningCertURL" : "https://sns.us-west-1.amazonaws.com/SimpleNotificationService-9c6465fa7f48f5cacd23014631ec1136.pem",\n  "UnsubscribeURL" : "https://sns.us-west-1.amazonaws.com/?Action=Unsubscribe&SubscriptionArn=arn:aws:sns:us-west-1:523571139036:email-received-notifications:d8582bd4-70d3-4cee-ae63-072f3981858e"\n}'


